{% extends "base.html" %}
{% block content %}
  <h1 class="page-title">Produtos</h1>

  <form class="form" method="post" action="{{ url_for('cadastrar_produto') }}">
    <input name="nome" placeholder="Nome do produto" required>
    <input name="preco" type="number" step="0.01" placeholder="Preço" required>
    <input name="estoque" type="number" min="0" value="0" placeholder="Estoque inicial">

    <select name="categoria_id">
      <option value="">-- categoria --</option>
      {% for c in categorias %}
        <option value="{{ c.id }}">{{ c.nome }}</option>
      {% endfor %}
    </select>

    <button type="submit" class="btn">Cadastrar</button>
  </form>

  <table class="table">
  <thead>
  <tr><th>ID</th><th>Nome</th><th>Categoria</th><th>Preço</th><th>Estoque</th><th>Ações</th></tr>
</thead>
<tbody>
  {% for p in produtos %}
    <tr>
      <td>{{ p.id }}</td>
      <td>{{ p.nome }}</td>
      <td>{{ p.categoria.nome if p.categoria else '-' }}</td>
      <td>R$ {{ "%.2f"|format(p.preco) }}</td>
      <td>{{ p.estoque }}</td>
      <td>
        <a class="btn-outline" href="{{ url_for('form_editar_produto', id=p.id) }}">Editar</a>
        <form method="post" action="{{ url_for('excluir_produto', id=p.id) }}" style="display:inline;">
          <button type="submit" class="btn-outline"
            onclick="return confirm('Excluir o produto {{ p.nome }}?')">Excluir</button>
        </form>
      </td>
    </tr>
  {% endfor %}
</tbody>

</table>
{% endblock %}
